<!DOCTYPE html>
<meta charset="UTF-8">
<title>Page Title</title>
<script src="https://unpkg.com/vue@3"></script>
<script src="https://unpkg.com/vue-router@4"></script>
<script src="https://cdn.jsdelivr.net/npm/vue3-sfc-loader@0.7.3"></script>
<script src="/common.js"></script>
<script type="module">
  const options = {
    moduleCache: {
      vue: Vue,
    },
    async getFile(url) {
      const res = await fetch(url);
      if (!res.ok) {
        throw Object.assign(new Error(res.statusText + ' ' + url), {res});
      }
      return await res.text();
    },
    addStyle(textContent) {
      const style = Object.assign(document.createElement('style'), {textContent});
      const ref = document.head.getElementsByTagName('style')[0] || null;
      document.head.insertBefore(style, ref);
    },
  };

  const {loadModule} = window['vue3-sfc-loader'];

  const Index = () => loadModule('/views/Index.vue', options);
  const Listing = () => loadModule('/views/Listing.vue', options);

  const routes = [
    {
      path: '/:species?',
      component: Index,
    },
    {
      path: '/:species/:pet',
      component: Listing,
    },
    {
      path: '/:pathMatch(.*)',
      redirect: (to) => r404(to.fullPath),
    },
  ];

  const router = VueRouter.createRouter({
    history: VueRouter.createWebHistory(),
    routes,
  });

  const app = Vue.createApp({template: '<router-view></router-view>'});
  app.use(router);
  app.mount(document.body);
</script>