RewriteEngine on

#Keep non-redundant directories from old site that would otherwise match below rules
RewriteCond %{REQUEST_FILENAME} -d
RewriteCond %{REQUEST_FILENAME} -f
RewriteRule .* - [L]
RewriteBase /

# Adoptable pages
RewriteRule ^([A-Z][A-Za-z]+s)$ $1/ [L,R]
RewriteRule ^([A-Z][A-Za-z]+)s/$ pages/adoptable.php?species=$1&$3&%{QUERY_STRING}
RewriteRule ^([A-Z][A-Za-z]+)s/[Ee]dit/?$ admin/edit_adoptable.php?species=$1&$3&%{QUERY_STRING} [L]
#Must be last as listing pages also match

# New pet
RewriteRule ^([A-Z][A-Za-z]+)s/[Nn]ew/?$ admin/edit_listing.php?species=$1&%{QUERY_STRING}
RewriteRule ^[Nn]ew/?(\?(.*))?$ admin/edit_listing.php?$2&%{QUERY_STRING}

# Listing pages
RewriteRule ^([A-Z][A-Za-z]+s)/([^?/.]+)$ $1/$2/ [L,R]
RewriteRule ^[A-Z][A-Za-z]+s/([^?.]+)(/(index\.[A-Za-z0-9]+)?)$ pages/listing.php?pet=$1&%{QUERY_STRING} [L]
#Must be last as image files also match
RewriteRule ^([A-Z][A-Za-z]+)s/([^?.]+)/[Ee]dit/?$ admin/edit_listing.php?pet=$2&species=$1&%{QUERY_STRING}

# Image files
RewriteRule ^[A-Z][A-Za-z]+s/([^?.]+)/([^?/.]+)\.(gif|jpe?g|png|GIF|JPE?G|PNG)$ pages/get_image.php?pet=$1&filename=$2&%{QUERY_STRING}.jpg
